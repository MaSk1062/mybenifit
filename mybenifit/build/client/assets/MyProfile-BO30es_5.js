import{w as $,r as a,j as e,b as V}from"./chunk-EF7DTUVF-Boj4Qu73.js";import{a as U,d as q}from"./firebase-Db5tcxcc.js";import{N as z}from"./nav-CVT91Aez.js";import{p as v}from"./firestore-yvp8jBDT.js";const h=({type:s="text",placeholder:n="",value:o,onChange:u,className:x="",...y})=>e.jsx("input",{type:s,placeholder:n,value:o,onChange:u,className:`w-full p-2 border border-black rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent ${x}`,...y}),l=({children:s,htmlFor:n,className:o=""})=>e.jsx("label",{htmlFor:n,className:`block text-sm font-medium text-black mb-1 ${o}`,children:s}),g=({children:s,onClick:n,className:o="",type:u="button",disabled:x=!1})=>e.jsx("button",{type:u,onClick:n,disabled:x,className:`px-4 py-2 rounded-md bg-black text-white hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed ${o}`,children:s});function J(){const[s,n]=a.useState(U.currentUser),[o,u]=a.useState(!0),[x,y]=a.useState(null),[c,w]=a.useState(""),[f,P]=a.useState(""),[p,E]=a.useState(""),[j,C]=a.useState(""),[N,I]=a.useState(0),[d,F]=a.useState(0),[m,L]=a.useState(0),[k,B]=a.useState(""),[i,S]=a.useState(!1),[A,M]=a.useState(!1);a.useEffect(()=>{const t=U.onAuthStateChanged(r=>{n(r),u(!1),r&&(w(r.displayName||""),P(r.email||""),O(r.uid))});return()=>t()},[]);const O=async t=>{try{const r=await v.getProfile(t);if(r)y(r),w(r.fullName||""),P(r.email||""),E(r.bio||""),C(r.location||""),I(r.age||0),F(r.height||0),L(r.weight||0),B(r.gender||"");else{const W={fullName:s?.displayName||"",email:s?.email||"",bio:"",location:"",age:0,height:0,weight:0,gender:""};await v.createProfile(W)}}catch(r){console.error("Error loading profile:",r)}},H=async()=>{if(s)try{M(!0);const t={fullName:c,email:f,bio:p,location:j,age:N,height:d,weight:m,gender:k};if(x?.id)await v.updateProfile(x.id,t);else{const r={fullName:c,email:f,bio:p,location:j,age:N,height:d,weight:m,gender:k};await v.createProfile(r)}await O(s.uid),S(!1)}catch(t){console.error("Error saving profile:",t),alert("Failed to save profile. Please try again.")}finally{M(!1)}},D=async()=>{try{await q(U)}catch(t){console.error("Error signing out:",t)}},G=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),R=()=>{if(!s)return"Unknown";const t=s.providerData;if(t.length>0)switch(t[0].providerId){case"google.com":return"Google";case"facebook.com":return"Facebook";case"twitter.com":return"Twitter";case"github.com":return"GitHub";case"password":return"Email/Password";default:return"Custom"}return"Email/Password"},b=(()=>{if(d>0&&m>0){const t=d/100;return(m/(t*t)).toFixed(1)}return null})(),T=b?parseFloat(b)<18.5?"Underweight":parseFloat(b)<25?"Normal weight":parseFloat(b)<30?"Overweight":"Obese":null;return o?e.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-black mx-auto"}),e.jsx("p",{className:"mt-4 text-black",children:"Loading profile..."})]})}):s?e.jsxs("div",{className:"min-h-screen flex flex-col bg-white",children:[e.jsx(z,{}),e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center py-12",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsx("h1",{className:"text-4xl font-extrabold text-black mb-8 text-center",children:"User Profile"}),e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg border border-black",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden mb-4 border-4 border-black",children:s.photoURL?e.jsx("img",{src:s.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-black flex items-center justify-center text-white text-3xl font-bold",children:c?c.charAt(0).toUpperCase():s.email?.charAt(0).toUpperCase()||"U"})}),e.jsx("h2",{className:"text-3xl font-bold text-black",children:c||"User"}),e.jsx("p",{className:"text-md text-black",children:f}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Member since ",s.metadata.creationTime?G(s.metadata.creationTime):"Recently"]})]}),e.jsxs("div",{className:"mb-8 p-6 bg-gray-100 rounded-lg border border-black",children:[e.jsx("h3",{className:"text-xl font-semibold text-black mb-4",children:"Account Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-black font-medium",children:"User ID"}),e.jsx("p",{className:"text-sm text-black font-mono bg-white p-2 rounded border border-black",children:s.uid})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-black font-medium",children:"Sign-in Provider"}),e.jsx("p",{className:"text-sm text-black bg-white p-2 rounded border border-black",children:R()})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-black font-medium",children:"Email Verified"}),e.jsx("p",{className:"text-sm text-black bg-white p-2 rounded border border-black",children:s.emailVerified?e.jsx("span",{className:"text-black font-medium",children:"✓ Verified"}):e.jsx("span",{className:"text-black font-medium",children:"✗ Not Verified"})})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-black font-medium",children:"Last Sign In"}),e.jsx("p",{className:"text-sm text-black bg-white p-2 rounded border border-black",children:s.metadata.lastSignInTime?G(s.metadata.lastSignInTime):"Unknown"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"userBio",className:"text-lg font-semibold text-black",children:"Bio"}),i?e.jsx("textarea",{id:"userBio",value:p,onChange:t=>E(t.target.value),className:"w-full p-3 border border-black rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent min-h-[100px]",rows:4,placeholder:"Tell us about yourself..."}):e.jsx("p",{className:"text-black mt-1 p-3 bg-gray-100 rounded-md border border-black",children:p||"No bio added yet."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"userName",className:"text-lg font-semibold text-black",children:"Full Name"}),i?e.jsx(h,{id:"userName",type:"text",value:c,onChange:t=>w(t.target.value),placeholder:"Enter your full name"}):e.jsx("p",{className:"text-black mt-1 p-3 bg-gray-100 rounded-md border border-black",children:c||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"userEmail",className:"text-lg font-semibold text-black",children:"Email"}),e.jsx("p",{className:"text-black mt-1 p-3 bg-gray-100 rounded-md border border-black",children:f}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Email cannot be changed"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"userLocation",className:"text-lg font-semibold text-black",children:"Location"}),i?e.jsx(h,{id:"userLocation",type:"text",value:j,onChange:t=>C(t.target.value),placeholder:"Enter your location"}):e.jsx("p",{className:"text-black mt-1 p-3 bg-gray-100 rounded-md border border-black",children:j||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"userAge",className:"text-lg font-semibold text-black",children:"Age"}),i?e.jsx(h,{id:"userAge",type:"number",value:N||0,onChange:t=>I(parseInt(t.target.value)||0),placeholder:"Enter your age",min:"1",max:"120"}):e.jsx("p",{className:"text-black mt-1 p-3 bg-gray-100 rounded-md border border-black",children:N||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"userHeight",className:"text-lg font-semibold text-black",children:"Height (cm)"}),i?e.jsx(h,{id:"userHeight",type:"number",value:d||0,onChange:t=>F(parseInt(t.target.value)||0),placeholder:"Enter your height in cm",min:"50",max:"300"}):e.jsx("p",{className:"text-black mt-1 p-3 bg-gray-100 rounded-md border border-black",children:d?`${d} cm`:"Not specified"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"userWeight",className:"text-lg font-semibold text-black",children:"Weight (kg)"}),i?e.jsx(h,{id:"userWeight",type:"number",value:m||0,onChange:t=>L(parseInt(t.target.value)||0),placeholder:"Enter your weight in kg",min:"20",max:"500"}):e.jsx("p",{className:"text-black mt-1 p-3 bg-gray-100 rounded-md border border-black",children:m?`${m} kg`:"Not specified"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"userGender",className:"text-lg font-semibold text-black",children:"Gender"}),i?e.jsxs("select",{id:"userGender",value:k,onChange:t=>B(t.target.value),className:"w-full p-2 border border-black rounded-md focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"}),e.jsx("option",{value:"prefer-not-to-say",children:"Prefer not to say"})]}):e.jsx("p",{className:"text-black mt-1 p-3 bg-gray-100 rounded-md border border-black",children:k||"Not specified"})]})]}),b&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg border border-black",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-2",children:"Health Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-black font-medium",children:"BMI"}),e.jsx("p",{className:"text-2xl font-bold text-black",children:b}),e.jsx("p",{className:"text-sm text-gray-600",children:T})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-black font-medium",children:"BMI Range"}),e.jsxs("p",{className:"text-sm text-black",children:["Underweight: < 18.5",e.jsx("br",{}),"Normal: 18.5 - 24.9",e.jsx("br",{}),"Overweight: 25 - 29.9",e.jsx("br",{}),"Obese: ≥ 30"]})]})]})]})]}),e.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[e.jsx(g,{onClick:D,className:"bg-black hover:bg-gray-800",children:"Sign Out"}),e.jsx("div",{className:"flex space-x-4",children:i?e.jsxs(e.Fragment,{children:[e.jsx(g,{onClick:()=>S(!1),className:"bg-gray-600 hover:bg-gray-700",children:"Cancel"}),e.jsx(g,{onClick:H,disabled:A,children:A?"Saving...":"Save Changes"})]}):e.jsx(g,{onClick:()=>S(!0),children:"Edit Profile"})})]})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-black mb-4",children:"Sign In Required"}),e.jsx("p",{className:"text-black mb-6",children:"Please sign in to view your profile."}),e.jsx(V,{to:"/signin",children:e.jsx(g,{children:"Sign In"})})]})})}const _=$(J);export{_ as default};
